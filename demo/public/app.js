function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t=function(){function t(e,i){var n=i.target,s=void 0===n?null:n,o=i.autoActivate,r=void 0!==o&&o,c=i.debug,h=void 0!==c&&c,a=i.styles,d=(a=void 0===a?{}:a).transition,l=void 0===d?1:d,f=a.focusIndex,u=void 0===f?10:f,v=i.posPriority,g=void 0===v?"bottom":v,y=i.padding,w=(y=void 0===y?{}:y).x,p=void 0===w?10:w,b=y.y,m=void 0===b?20:b,k=i.bPadding,P=(k=void 0===k?{}:k).x,Y=void 0===P?25:P,S=k.y,W=void 0===S?50:S,T=i.watchRefreshSeconds,E=void 0===T?.5:T;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),h&&console.warn("attacher component created.",this),this.reference=e,this.target=s,this.debug=h,this.autoActivate=r,this.focusIndex=u,this.posPriority=g,this.transition=l,this.paddingX=p,this.paddingY=m,this.bPaddingX=Y,this.bPaddingY=W,this.forcedPosPriority=!1,this.watchRefreshSeconds=E,this.windowWidth=window.innerWidth,s&&this.bind(s),this.watchBlurEvents()}var i,n,s;return i=t,(n=[{key:"bind",value:function(e){var t=this;this.target=e,this.setStyles(),this.autoActivate&&setTimeout(function(){t.activate(!0)},100),this.debug&&console.log("Attacher bind method fired.")}},{key:"unbind",value:function(){this.debug&&console.log("Attacher unbind method fired."),this.resetStyles(),this.target=void 0,this.deactivate()}},{key:"activate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.switchFocus(),this.refresh(),t&&setTimeout(function(){e.setTransitionStyle()},100),this.startWatch()}},{key:"deactivate",value:function(){this.reference.style.transition="",this.reference.style.left="",this.stopWatch()}},{key:"switchFocus",value:function(){document.dispatchEvent(new CustomEvent("blurAttacher")),this.reference.style.zIndex=this.focusIndex}},{key:"setStyles",value:function(){this.reference.style.position="absolute",this.reference.style.zIndex=1}},{key:"resetStyles",value:function(){this.reference.style.position="",this.reference.style.zIndex="",this.reference.style.transition="",this.reference.style.left="",this.reference.style.top=""}},{key:"setTransitionStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.transition;e.style.transition="".concat(t,"s")}},{key:"unsetTransitionStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.reference;arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content;e.style.transition=""}},{key:"refresh",value:function(){null!=this.target?this.setPosition(this.getPosition()):this.debug&&console.warn("Attacher can't refresh. Target is undefined.")}},{key:"getPosition",value:function(){var e=this.target.getBoundingClientRect(),t=this.offsetPositionX(e.left+window.scrollX),i=this.offsetPositionY(e.top+window.scrollY);return this.targetPosY=i,{left:t,top:i}}},{key:"setPosition",value:function(e){this.reference.style.left="".concat(e.left,"px"),this.reference.style.top="".concat(e.top,"px"),this.reference.style.transform=""}},{key:"offsetPositionX",value:function(e){var t=e-this.reference.offsetWidth/2+this.target.offsetWidth/2,i=window.innerWidth;return t+this.reference.offsetWidth+this.paddingX>i?(this.debug&&console.log("Reference bleeds from right."),i-this.reference.offsetWidth-this.paddingX):t-this.paddingX<0?(this.debug&&console.log("Reference bleeds from left."),0+this.paddingX):t}},{key:"offsetPositionY",value:function(e){var t=this.repositionPivotY(e);switch(this.checkBleedingY(t)){case"top":t=this.repositionPivotY(e,"bottom");break;case"bottom":t=this.repositionPivotY(e,"top")}return t}},{key:"repositionPivotY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.posPriority,i=0;switch(t){case"center":i=e;break;case"top":i=e-this.reference.offsetHeight-this.paddingY;break;case"bottom":i=e+this.target.offsetHeight+this.paddingY}return i}},{key:"checkBleedingY",value:function(e){var t=window.scrollY;if(t>=e-this.bPaddingY)return this.debug&&console.log("Reference bleeds from top."),this.forcedPosPriority="bottom","top";var i=t+window.innerHeight;return e+this.reference.offsetHeight+this.bPaddingY>i?(this.debug&&console.log("Reference bleeds from bottom."),this.forcedPosPriority="top","bottom"):(this.forcedPosPriority=!1,!1)}},{key:"watchBlurEvents",value:function(){var e=this;document.addEventListener("blurAttacher",this.blurAttacher=function(){e.reference.style.zIndex=1,e.debug&&console.log("blurAttacher event fired.")})}},{key:"startWatch",value:function(){var e=this;this.eventListenersCreated||(document.addEventListener("scroll",this.scrollWatcher=function(){e.sleepMode||e.autoRefresh(),e.switchToSleepMode()},{passive:!0}),window.addEventListener("resize",this.resizeWatcher=function(){e.windowWidth!=window.innerWidth&&(e.debug&&console.warn("Document resized."),e.reference.style.display="none",e.resetStyles(),setTimeout(function(){e.reference.style.display="",e.setStyles(),e.refresh()},100),setTimeout(function(){e.setTransitionStyle()},200),e.windowWidth=window.innerWidth,e.debug&&console.warn("new screen width set to default"))}),this.eventListenersCreated=!0,this.debug&&console.warn("attacher started watching."))}},{key:"stopWatch",value:function(){document.removeEventListener("scroll",this.scrollWatcher),window.removeEventListener("resize",this.resizeWatcher),this.eventListenersCreated=!1,this.debug&&console.warn("attacher stopped watching.")}},{key:"autoRefresh",value:function(){var e=this;this.checkBleedingTimer||this.forcedPosPriority!=this.checkBleedingY(this.targetPosY)&&(this.debug&&console.log("Refresh requested."),setTimeout(function(){e.checkBleedingTimer=!1,e.refresh(),e.debug&&console.log("Refreshed.")},1e3*this.watchRefreshSeconds),this.checkBleedingTimer=!0)}},{key:"switchToSleepMode",value:function(){if(window.scrollY>this.reference.offsetTop+this.reference.offsetHeight||this.reference.offsetTop>window.scrollY+window.innerHeight)return this.debug&&0==this.sleepMode&&console.warn("attacher switched to sleep mode."),void(this.sleepMode=!0);this.debug&&1==this.sleepMode&&console.warn("attacher switched off sleep mode."),this.sleepMode=!1}}])&&e(i.prototype,n),s&&e(i,s),t}(),i=document.querySelector(".reference--interactive"),n=document.querySelector(".reference-touch"),s=document.querySelectorAll(".target"),o=new t(i,{touchSurface:n,target:s[0],posPriority:"top",debug:!0,autoActivate:!0,styles:{focusIndex:10}}),r=!0;document.addEventListener("keyup",function(e){e.preventDefault(),66==e.keyCode&&i.classList.toggle("reference--bleed"),32==e.keyCode&&(r?o.deactivate():o.activate(),r=!r)}),i.addEventListener("click",function(e){});for(var c=0;c<s.length;c++){s[c].addEventListener("click",function(e){e.preventDefault(),o.bind(e.target)})}
